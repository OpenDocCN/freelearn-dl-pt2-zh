- en: '*Appendix*'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*附录*'
- en: About
  id: totrans-1
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 关于
- en: This section is included to assist the students to perform the activities in
    the book. It includes detailed steps that are to be performed by the students
    to achieve the objectives of the activities.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 这一部分包括帮助学生执行书中活动的步骤。它包括详细的步骤，学生需要执行这些步骤以实现活动的目标。
- en: 'Chapter 1: Introduction to Deep Learning and PyTorch'
  id: totrans-3
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第 1 章：深度学习和 PyTorch 简介
- en: 'Activity 1: Creating a Single-Layer Neural Network'
  id: totrans-4
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 1：创建单层神经网络
- en: 'Solution:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import the required libraries:'
  id: totrans-6
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入所需库：
- en: '[PRE0]'
  id: totrans-7
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Create dummy input data (`x`) of random values and dummy target data (`y`)
    that only contains 0s and 1s. Store the data in PyTorch tensors. Tensor `x` should
    have a size of (100,5), while the size of `y` should be (100,1):'
  id: totrans-8
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建随机值的虚拟输入数据 (`x`) 和仅包含 0 和 1 的虚拟目标数据 (`y`)。将数据存储在 PyTorch 张量中。张量 `x` 应该大小为
    (100,5)，而 `y` 的大小应为 (100,1)：
- en: '[PRE1]'
  id: totrans-9
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Define the architecture of the model and store it in a variable named `model`.
    Remember to create a single-layer model:'
  id: totrans-10
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义模型的架构并将其存储在名为 `model` 的变量中。记得创建一个单层模型：
- en: '[PRE2]'
  id: totrans-11
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Define the loss function to be used. Use the Mean Square Error loss function:'
  id: totrans-12
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 定义要使用的损失函数。使用均方误差损失函数：
- en: '[PRE3]'
  id: totrans-13
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Define the optimizer of your model. Use the Adam optimizer and a learning rate
    of 0.01:'
  id: totrans-14
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 定义模型的优化器。使用 Adam 优化器和学习率为 0.01：
- en: '[PRE4]'
  id: totrans-15
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Run the optimization for 100 iterations. In each iteration, print and save
    the loss value:'
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行 100 次优化迭代。在每次迭代中，打印并保存损失值：
- en: '[PRE5]'
  id: totrans-17
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: The final loss should be approximately 0.238.
  id: totrans-18
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 最终损失应约为 0.238。
- en: 'Print the values of the final weights and bias. There should be a total of
    five weights (one for each feature of the input data) and one bias value:'
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打印最终权重和偏置的值。应该有五个权重（每个输入数据特征一个）和一个偏置值：
- en: '[PRE6]'
  id: totrans-20
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Make a line plot to display the loss value for each iteration step:'
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 制作线图以显示每次迭代步骤的损失值：
- en: '[PRE7]'
  id: totrans-22
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The resulting plot should look as follows:'
  id: totrans-23
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 结果图应该如下所示：
- en: '![Figure 1.8: Loss function throughout the training process](img/C11865_01_08.jpg)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![图 1.8：训练过程中的损失函数](img/C11865_01_08.jpg)'
- en: 'Figure 1.8: Loss function throughout the training process'
  id: totrans-25
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 1.8：训练过程中的损失函数
- en: 'Chapter 2: Building Blocks of Neural Networks'
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第 2 章：神经网络的构建模块
- en: 'Activity 2: Performing Data Preparation'
  id: totrans-27
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 2：执行数据准备
- en: 'Solution:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import the required libraries:'
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入所需库：
- en: '[PRE8]'
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Using pandas, load the text file. Considering that the previously downloaded
    text file has the same formatting as a CSV file, you can read it using the `read_csv()`
    function. Make sure to change the header argument to `None`:'
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 pandas 加载文本文件。考虑到之前下载的文本文件与 CSV 文件的格式相同，可以使用 `read_csv()` 函数读取它。确保将 header
    参数更改为 `None`：
- en: '[PRE9]'
  id: totrans-32
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Note
  id: totrans-33
  prefs:
  - PREF_IND
  - PREF_H4
  type: TYPE_NORMAL
  zh: 注意
- en: To avoid memory limitations, use the `nrows` argument when reading the text
    file in order to read a smaller section of the entire dataset. In the preceding
    example, we are reading the first 50,000 rows.
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 为避免内存限制，在读取文本文件时使用 `nrows` 参数以读取整个数据集的较小部分。在上述示例中，我们读取了前 50,000 行。
- en: Verify whether any qualitative data is present in the dataset.
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 验证数据集中是否存在任何定性数据。
- en: '[PRE10]'
  id: totrans-36
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Check for missing values.
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查缺失值。
- en: 'If you add an additional `sum()` function to the line of code previously used
    for this purpose, you will get the sum of missing values in the entire dataset,
    without discriminating by column:'
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果在之前用于此目的的代码行中添加额外的 `sum()` 函数，则将获得整个数据集中缺失值的总和，而不区分列：
- en: '[PRE11]'
  id: totrans-39
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Check for outliers:'
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查异常值：
- en: '[PRE12]'
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Separate the features from the target data:'
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将特征与目标数据分开：
- en: '[PRE13]'
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Rescale the features data using the standardization methodology:'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用标准化方法对特征数据进行重新缩放：
- en: '[PRE14]'
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Split the data into three sets: training, validation, and testing. Use the
    approach of your preference:'
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将数据分割为三组：训练集、验证集和测试集。使用您偏好的方法：
- en: '[PRE15]'
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'The resulting shapes should be as follows:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 结果的形状应该如下所示：
- en: '[PRE16]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Activity 3: Performing Data Preparation'
  id: totrans-50
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 3：执行数据准备
- en: 'Solution:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import the required libraries:'
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入所需库：
- en: '[PRE17]'
  id: totrans-53
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Split the features from the targets for all three sets of data created in the
    previous activity. Convert the DataFrames into tensors:'
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将先前活动中创建的所有三组数据的特征与目标分离。将 DataFrame 转换为张量：
- en: '[PRE18]'
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Define the architecture of the network. Feel free to try different combinations
    for the number of layers and the number of units per layer:'
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义网络的架构。可以尝试不同的层数和每层单元的组合：
- en: '[PRE19]'
  id: totrans-57
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'Define the loss function and the optimizer algorithm:'
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义损失函数和优化器算法：
- en: '[PRE20]'
  id: totrans-59
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Use a `for` loop to train the network for 100 iteration steps:'
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `for` 循环训练网络进行 100 次迭代步骤：
- en: '[PRE21]'
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Test your model by performing a prediction on the first instance of the testing
    set and comparing it to the ground truth:'
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过对测试集的第一个实例进行预测并将其与实际值进行比较来测试您的模型：
- en: '[PRE22]'
  id: totrans-63
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Your output should look similar to this:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 您的输出应类似于此：
- en: '![Figure 2.29: Output of the activity](img/C11865_02_29.jpg)'
  id: totrans-65
  prefs: []
  type: TYPE_IMG
  zh: '![Figure 2.29: 活动输出](img/C11865_02_29.jpg)'
- en: 'Figure 2.29: Output of the activity'
  id: totrans-66
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2.29：活动输出
- en: 'Chapter 3: A Classification Problem Using DNNs'
  id: totrans-67
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第 3 章：使用深度神经网络的分类问题
- en: 'Activity 4: Building an ANN'
  id: totrans-68
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 4：构建人工神经网络
- en: 'Solution:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import the following libraries:'
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入以下库：
- en: '[PRE23]'
  id: totrans-71
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Read the previously prepared dataset, which should have been named `dccc_prepared.csv`:'
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 读取之前准备好的数据集，该数据集应命名为`dccc_prepared.csv`：
- en: '[PRE24]'
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Separate the features from the target:'
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将特征从目标分离开：
- en: '[PRE25]'
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Using scikit-learn''s `train_test_split` function, split the dataset into training,
    validation, and testing sets. Use a 60/20/20% split ratio. Set `random_state`
    as 0:'
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用scikit-learn的`train_test_split`函数将数据集分割为训练、验证和测试集。使用60/20/20%的分割比例。将`random_state`设置为0：
- en: '[PRE26]'
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'The final shapes of each of the sets is shown here:'
  id: totrans-78
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 各个集合的最终形状如下所示：
- en: '[PRE27]'
  id: totrans-79
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: Convert the validation and testing sets to tensors, considering that the features
    matrices should be of type float, while the target matrices should not.
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将验证和测试集转换为张量，考虑到特征矩阵应为浮点类型，而目标矩阵不应为浮点类型。
- en: Leave the training sets unconverted for the moment as they will undergo further
    transformations.
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 暂时保持训练集未转换，因为它们将经历进一步的转换。
- en: '[PRE28]'
  id: totrans-82
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'Build a custom module class defining the layers of the network. Include a forward
    function that specifies the activation functions that will be applied to the output
    of each layer. Use ReLU for all layers, except for the output, where you should
    use `log_softmax`:'
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 构建自定义模块类来定义网络的层。包括一个前向函数，该函数指定将应用于每个层输出的激活函数。对于所有层使用ReLU，输出层使用`log_softmax`：
- en: '[PRE29]'
  id: totrans-84
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'Define all the variables required for the training of the model. Set the number
    of epochs to 50 and the batch size to 128\. Use a learning rate of 0.001:'
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义训练模型所需的所有变量。将训练周期设置为50，批量大小设置为128。使用学习率为0.001：
- en: '[PRE30]'
  id: totrans-86
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'Train the network using the training sets data. Use the validation sets to
    measure performance. To do so, save the loss and the accuracy for both the training
    and validation sets in each epoch:'
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用训练集数据训练网络。使用验证集来衡量性能。在每个周期中保存训练和验证集的损失和准确率：
- en: '[PRE31]'
  id: totrans-88
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Plot the loss of both sets:'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制两组数据的损失：
- en: '[PRE32]'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE32]'
- en: The resulting plot should look similar to the one here, albeit with some differences,
    considering that the shuffling of the training data may derive slightly different
    results.
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 生成的图表应该与此处类似，尽管由于训练数据的洗牌可能会导致略有不同的结果。
- en: '![Figure 3.10: A plot displaying the training and validation losses'
  id: totrans-92
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![Figure 3.10: 显示训练和验证损失的图表](img/C11865_03_10.jpg)'
- en: '](img/C11865_03_10.jpg)'
  id: totrans-93
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![Figure 3.11: 显示两组数据准确率的图表](img/C11865_03_10.jpg)'
- en: 'Figure 3.10: A plot displaying the training and validation losses'
  id: totrans-94
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3.10：显示训练和验证损失的图表
- en: 'Plot the accuracy of both sets:'
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制两组数据的准确率：
- en: '[PRE33]'
  id: totrans-96
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Here is the plot derived from this code snippet:'
  id: totrans-97
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这是从此代码片段生成的图表：
- en: '![Figure 3.11: A plot displaying the accuracy of the sets](img/C11865_03_11.jpg)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![Figure 3.11: 显示两组数据准确率的图表](img/C11865_03_11.jpg)'
- en: 'Figure 3.11: A plot displaying the accuracy of the sets'
  id: totrans-99
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3.11：显示集合准确度的图表
- en: 'Activity 5: Improving a Model''s Performance'
  id: totrans-100
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 5：提升模型性能
- en: 'Solution:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import the same libraries as those in the previous activity:'
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入与上一个活动中相同的库：
- en: '[PRE34]'
  id: totrans-103
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Load the data and split the features from the target. Next, split the data
    into the three subsets (training, validation, and testing), using a 60:20:20 split
    ratio. Finally, convert the validation and testing sets into PyTorch tensors,
    just as you did in the previous activity:'
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载数据并将特征与目标分离。然后，使用60:20:20的比例将数据分割为三个子集（训练、验证和测试），最后，像在上一个活动中一样将验证和测试集转换为PyTorch张量：
- en: '[PRE35]'
  id: totrans-105
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: Considering that the model is suffering from high bias, the focus should be
    on increasing the number of epochs or increasing the size of the network by adding
    additional layers or units to each layer.
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 考虑到模型存在高偏差问题，重点应该是增加训练周期或者通过增加额外的层或单元来扩展网络的规模。
- en: The aim should be to approximate the accuracy over the validation set to 80%.
  id: totrans-107
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 目标应该是将验证集的准确率近似到80%。
- en: 'The following code snippet is from the best-performing model, which was achieved
    after several fine-tuning attempts:'
  id: totrans-108
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 下面的代码片段来自经过多次微调后表现最佳的模型：
- en: '[PRE36]'
  id: totrans-109
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE36]'
- en: Note
  id: totrans-110
  prefs:
  - PREF_IND
  - PREF_H4
  type: TYPE_NORMAL
  zh: 注意
- en: The accompanying Jupyter notebook for this activity can be found over in the
    GitHub repository that was previously shared. There, you will find the different
    attempts at fine-tuning the model, with their results. The best-performing model
    is found at the end of the notebook.
  id: totrans-111
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 与此活动相关的Jupyter笔记本可以在之前分享的GitHub存储库中找到。在那里，您将找到微调模型的不同尝试及其结果。表现最佳的模型位于笔记本的末尾。
- en: 'Plot the loss and accuracy for both sets of data:'
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制两组数据的损失和准确性图表：
- en: Note
  id: totrans-113
  prefs:
  - PREF_IND
  - PREF_H4
  type: TYPE_NORMAL
  zh: 注意
- en: '[PRE37]'
  id: totrans-114
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE37]'
- en: '![Figure 3.12: A plot displaying the loss of the sets](img/C11865_03_12.jpg)'
  id: totrans-115
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![Figure 3.12: 显示损失的图表](img/C11865_03_12.jpg)'
- en: 'Figure 3.12: A plot displaying the loss of the sets'
  id: totrans-116
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 'Figure 3.12: 显示损失的图表'
- en: '[PRE38]'
  id: totrans-117
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE38]'
- en: '![Figure 3.13: A plot displaying the accuracy of the sets'
  id: totrans-118
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![Figure 3.13: 显示准确性的图表'
- en: '](img/C11865_03_13.jpg)'
  id: totrans-119
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '](img/C11865_03_13.jpg)'
- en: 'Figure 3.13: A plot displaying the accuracy of the sets'
  id: totrans-120
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 'Figure 3.13: 显示准确性的图表'
- en: 'Using the best-performing model, perform prediction over the testing set (which
    should not have been used during the fine-tuning process). Compare the prediction
    to the ground truth by calculating the accuracy of the model over this set:'
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用表现最佳的模型，在测试集上进行预测（在微调过程中不应使用）。通过计算模型在此集合上的准确性，将预测与实际情况进行比较：
- en: '[PRE39]'
  id: totrans-122
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE39]'
- en: The accuracy obtained through the model architecture and the parameters defined
    above should be around 80%.
  id: totrans-123
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 通过上述模型架构和定义的参数，获得的准确率应约为80%。
- en: 'Activity 6: Making Use of Your Model'
  id: totrans-124
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动6：使用您的模型
- en: 'Solution:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: Open the Jupyter notebook that you used for the previous activity.
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开您用于上一个活动的Jupyter笔记本。
- en: Save a Python file containing the class where you define the architecture of
    your best-performing module. Make sure to import PyTorch's required libraries
    and modules. Name it `final_model.py`.
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存一个Python文件，其中包含定义表现最佳模块架构的类。确保导入PyTorch所需的库和模块。将其命名为`final_model.py`。
- en: 'The file should look as follows:'
  id: totrans-128
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 文件应如下所示：
- en: '![Figure 3.14: A screenshot of final_model.py](img/C11865_03_14.jpg)'
  id: totrans-129
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![Figure 3.14: final_model.py 的屏幕截图](img/C11865_03_14.jpg)'
- en: 'Figure 3.14: A screenshot of final_model.py'
  id: totrans-130
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 'Figure 3.14: final_model.py 的屏幕截图'
- en: 'Save the best-performing model. Make sure to save the information of the input
    units, along with the parameters of the model. Name it `checkpoint.pth`:'
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存表现最佳的模型。确保保存输入单元的信息以及模型的参数。将其命名为`checkpoint.pth`：
- en: '[PRE40]'
  id: totrans-132
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE40]'
- en: Open a new Jupyter notebook.
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一个新的Jupyter笔记本。
- en: 'Import PyTorch, as well as the Python file previously created:'
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入PyTorch以及先前创建的Python文件：
- en: '[PRE41]'
  id: totrans-135
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'Create a function that loads the model:'
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个加载模型的函数：
- en: '[PRE42]'
  id: totrans-137
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'Perform a prediction by inputting the following tensor into your model:'
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将以下张量输入到模型中进行预测：
- en: '[PRE43]'
  id: totrans-139
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE43]'
- en: By printing `top_class_test`, we obtain the prediction of the model, which in
    this case is equal to 1 (yes).
  id: totrans-140
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 通过打印`top_class_test`，我们获得模型的预测结果，这里等于1（是）。
- en: 'Convert the model using the JIT module:'
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用JIT模块转换模型：
- en: '[PRE44]'
  id: totrans-142
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'Perform a prediction by inputting the following information to the traced script
    of your model:'
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过将以下信息输入到模型的跟踪脚本中进行预测：
- en: '[PRE45]'
  id: totrans-144
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE45]'
- en: By printing `top_class_test_2`, we get the prediction from the traced script
    representation of your model, which again is equal to 1 (yes).
  id: totrans-145
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 通过打印`top_class_test_2`，我们从模型的跟踪脚本表示中获取预测结果，再次等于1（是）。
- en: 'Chapter 4: Convolutional Neural Networks'
  id: totrans-146
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第4章：卷积神经网络
- en: 'Activity 7: Building a CNN for an Image Classification Problem'
  id: totrans-147
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动7：为图像分类问题构建CNN
- en: 'Solution:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import the following libraries:'
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入以下库：
- en: '[PRE46]'
  id: totrans-150
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'Set the transformations to be performed on the data, which will be the conversion
    of the data to tensors and the normalization of the pixel values:'
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置在数据上执行的转换，即将数据转换为张量并标准化像素值：
- en: '[PRE47]'
  id: totrans-152
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'Set a batch size of 100 images and download both the training and testing data
    from the `CIFAR10` dataset:'
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置一个批次大小为100张图像，并从`CIFAR10`数据集下载训练和测试数据：
- en: '[PRE48]'
  id: totrans-154
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'Using a validation size of 20%, define the training and validation sampler
    that will be used to divide the dataset into those 2 sets:'
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用20%的验证集大小，定义训练和验证采样器，用于将数据集分成这两组：
- en: '[PRE49]'
  id: totrans-156
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'Use the `DataLoader()` function to define the batches of each set of data to
    be used:'
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`DataLoader()`函数定义每组数据的批处理：
- en: '[PRE50]'
  id: totrans-158
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'Define the architecture of your network. Use the following information to do
    so:'
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义网络的架构。使用以下信息来完成这一步骤：
- en: 'Conv1: A convolutional layer that takes as input the colored image and passes
    it through 10 filters of size 3\. Both the padding and the stride should be set
    to 1.'
  id: totrans-160
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Conv1：一个卷积层，以彩色图像作为输入，并通过大小为 3 的 10 个滤波器进行处理。填充和步长都应设置为 1。
- en: 'Conv2: A convolutional layer that passes the input data through 20 filters
    of size 3\. Both the padding and the stride should be set to 1.'
  id: totrans-161
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Conv2：一个卷积层，将输入数据通过大小为 3 的 20 个滤波器进行处理。填充和步长都应设置为 1。
- en: 'Conv3: A convolutional layer that passes the input data through 40 filters
    of size 3\. Both the padding and the stride should be set to 1.'
  id: totrans-162
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Conv3：一个卷积层，将输入数据通过大小为 3 的 40 个滤波器进行处理。填充和步长都应设置为 1。
- en: Use the ReLU activation function after each convolutional layer.
  id: totrans-163
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在每个卷积层后使用 ReLU 激活函数。
- en: A pooling layer after each convolutional layer, with a filter size and stride
    of 2.
  id: totrans-164
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每个卷积层后都有一个池化层，滤波器大小和步长均为 2。
- en: A dropout term set to 20%, after flattening the image.
  id: totrans-165
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在展平图像后设置的 20% 的 dropout 项。
- en: 'Linear1: A fully-connected layer that receives as input the flattened matrix
    from the previous layer and generates an output of 100 units. Use the ReLU activation
    function for this layer. A dropout term here is set to 20%.'
  id: totrans-166
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Linear1：一个完全连接的层，接收前一层展平矩阵作为输入，并生成 100 个单元的输出。此层使用 ReLU 激活函数。这里的 dropout 项设置为
    20%。
- en: 'Linear2: A fully-connected layer that generates 10 outputs, one for each class
    label. Use the `log_softmax` activation function for the output layer:'
  id: totrans-167
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Linear2：一个完全连接的层，生成 10 个输出，每个类标签一个。输出层使用 `log_softmax` 激活函数：
- en: '[PRE51]'
  id: totrans-168
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'Define all of the parameters required to train your model. Train it for 100
    epochs:'
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义训练模型所需的所有参数。将其训练 100 个 epochs：
- en: '[PRE52]'
  id: totrans-170
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'Train your network and be sure to save the values for the loss and accuracy
    of both the training and validation sets:'
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 训练你的网络，并确保保存训练和验证集的损失和准确性值：
- en: '[PRE53]'
  id: totrans-172
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE53]'
- en: 'Plot the loss and accuracy of both sets:'
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制两组集合的损失和准确性：
- en: '[PRE54]'
  id: totrans-174
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE54]'
- en: 'The resulting plot should look similar to this:'
  id: totrans-175
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 结果图应该类似于这样：
- en: '![Figure 4.19: Resulting plot showing loss of sets](img/C11865_04_19.jpg)'
  id: totrans-176
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 4.19：显示集合损失的结果图](img/C11865_04_19.jpg)'
- en: 'Figure 4.19: Resulting plot showing loss of sets'
  id: totrans-177
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4.19：显示集合损失的结果图
- en: '[PRE55]'
  id: totrans-178
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'The accuracy should look similar to the next graph:'
  id: totrans-179
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 准确性应该类似于下一个图表：
- en: '![Figure 4.20: Resulting plot showing accuracy of sets](img/C11865_04_20.jpg)'
  id: totrans-180
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 4.20：显示集合准确性的结果图](img/C11865_04_20.jpg)'
- en: 'Figure 4.20: Resulting plot showing accuracy of sets'
  id: totrans-181
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4.20：显示集合准确性的结果图
- en: As can be seen, after the fifteenth epoch, overfitting starts to affect the
    model.
  id: totrans-182
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 可以看出，在第十五个 epoch 后，过拟合开始影响模型。
- en: 'Check the model''s accuracy on the testing set:'
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查模型在测试集上的准确性：
- en: '[PRE56]'
  id: totrans-184
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE56]'
- en: The accuracy on the testing set is very similar to the accuracy achieved on
    the other 2 sets, which means that the model has the capability to perform equally
    well on unseen data. It should be around 72%.
  id: totrans-185
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 测试集上的准确性非常接近于其他两个集合的准确性，这意味着模型在未见数据上同样表现出色。应该约为 72%。
- en: 'Activity 8: Implementing Data Augmentation'
  id: totrans-186
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 8：实施数据增强
- en: 'Solution:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: Duplicate the notebook from the previous activity.
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 复制前一个活动中的笔记本。
- en: To solve this activity, no code will be altered besides the definition of the
    variable mentioned in the next step.
  id: totrans-189
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 要解决此活动，除了在下一步中提到的变量定义外，不会更改任何代码。
- en: 'Change the definition of the `transform` variable to include, in addition to
    normalizing and converting the data into tensors, the following transformations:'
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更改 `transform` 变量的定义，除了将数据标准化并转换为张量外，还包括以下转换：
- en: For the training/validation sets, a `RandomHorizontalFlip` function with a probability
    of 50% (0.5) and a `RandomGrayscale` function with a probability of 10% (0.1).
  id: totrans-191
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于训练/验证集，使用 `RandomHorizontalFlip` 函数，概率为 50%（0.5），以及 `RandomGrayscale` 函数，概率为
    10%（0.1）。
- en: 'For the testing set, do not add any other transformation:'
  id: totrans-192
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于测试集，不添加任何其他转换：
- en: '[PRE57]'
  id: totrans-193
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE57]'
- en: Train the model for 100 epochs.
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将模型训练 100 个 epochs。
- en: 'The resulting plots for loss and accuracy on the training and validation sets
    should be similar to the ones displayed as follows:'
  id: totrans-195
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在训练和验证集上的损失和准确性的结果图应与以下显示的图表类似：
- en: '![Figure 4.21: Resulting plot showing loss of sets](img/C11865_04_21.jpg)'
  id: totrans-196
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 4.21：显示集合损失的结果图](img/C11865_04_21.jpg)'
- en: 'Figure 4.21: Resulting plot showing loss of sets'
  id: totrans-197
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4.21：显示集合损失的结果图
- en: '![Figure 4.22: Resulting plot showing accuracy of sets](img/C11865_04_22.jpg)'
  id: totrans-198
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 4.22：显示集合准确性的结果图](img/C11865_04_22.jpg)'
- en: 'Figure 4.22: Resulting plot showing accuracy of sets'
  id: totrans-199
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4.22：显示集合准确性的结果图
- en: By adding data augmentation, it is possible to improve the performance of the
    model as well as to reduce the overfitting that was occurring.
  id: totrans-200
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 通过增加数据增强，可以改善模型的性能，并减少过拟合现象。
- en: Calculate the accuracy of the resulting model on the testing set.
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算模型在测试集上的准确率。
- en: The performance of the model on the testing set has gone up to around 76%.
  id: totrans-202
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 模型在测试集上的性能提升到了约76%。
- en: 'Activity 9: Implementing Batch Normalization'
  id: totrans-203
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 9：实现批量归一化
- en: 'Solution:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: Duplicate the notebook from the previous activity.
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 复制上一个活动的笔记本。
- en: Add batch normalization to each convolutional layer, as well as to the first
    fully-connected layer.
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在每个卷积层以及第一个全连接层中添加批量归一化。
- en: 'The resulting architecture of the network should be as follows:'
  id: totrans-207
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 网络的最终架构应如下所示：
- en: '[PRE58]'
  id: totrans-208
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE58]'
- en: Train the model for 100 epochs.
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将模型训练100个epochs。
- en: 'The resulting plots of the loss and accuracy on the training and validation
    sets should be similar to the ones displayed next:'
  id: totrans-210
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在训练和验证集上显示的损失和准确率的结果图应与接下来显示的图表类似：
- en: '![Figure 4.23: Resulting plot showing loss of sets](img/C11865_04_23.jpg)'
  id: totrans-211
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 4.23：显示损失的结果图](img/C11865_04_23.jpg)'
- en: 'Figure 4.23: Resulting plot showing loss of sets'
  id: totrans-212
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4.23：显示损失的结果图
- en: '![Figure 4.24: Resulting plot showing loss of sets](img/C11865_04_24.jpg)'
  id: totrans-213
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图 4.24：显示损失的结果图](img/C11865_04_24.jpg)'
- en: 'Figure 4.24: Resulting plot showing loss of sets'
  id: totrans-214
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4.24：显示损失的结果图
- en: Although overfitting was introduced to the model again, it is possible to see
    that the performance on both sets has gone up.
  id: totrans-215
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 尽管模型再次出现过拟合问题，但可以看到两组数据的性能都有所提升。
- en: Note
  id: totrans-216
  prefs:
  - PREF_IND
  - PREF_H4
  type: TYPE_NORMAL
  zh: 注意
- en: Although it is not explored in this chapter, an ideal step would be to add dropout
    to the architecture of the network in order to reduce high variance. Feel free
    to try it to see if you are able to improve the performance even more.
  id: totrans-217
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 虽然本章未探讨此项内容，但理想的步骤将是在网络架构中添加dropout，以减少高方差。随时尝试，看看能否进一步提升性能。
- en: Calculate the accuracy of the resulting model on the testing set.
  id: totrans-218
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算模型在测试集上的准确率。
- en: The accuracy of the model on the testing set should be around 78%.
  id: totrans-219
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 模型在测试集上的准确率应该在78%左右。
- en: 'Chapter 5: Style Transfer'
  id: totrans-220
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第5章：风格转移
- en: 'Activity 10: Performing Style Transfer'
  id: totrans-221
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 10：执行风格转移
- en: 'Solution:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: Note
  id: totrans-223
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 注意
- en: To be able to run this activity for many iterations (30,000) a GPU was used.
    According to this, a copy adapting the following code to work using GPUs can be
    found in the GitHub's repository.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 为了能够在许多迭代（30,000次）中运行此活动，使用了GPU。根据这一点，可以在GitHub的存储库中找到适用于GPU的代码副本。
- en: 'Import the required libraries:'
  id: totrans-225
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入所需的库：
- en: '[PRE59]'
  id: totrans-226
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE59]'
- en: 'Specify the transformations to be performed over the input images. Be sure
    to resize them to the same size, convert them to tensor, and normalize them:'
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 指定对输入图像执行的转换。确保将它们调整为相同大小，转换为张量并进行归一化：
- en: '[PRE60]'
  id: totrans-228
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE60]'
- en: 'Define an image loader function. It should open the image and load it. Call
    the image loader function to load both input images:'
  id: totrans-229
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义一个图像加载函数。它应打开并加载图像。调用图像加载函数加载两幅输入图像：
- en: '[PRE61]'
  id: totrans-230
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE61]'
- en: 'To be able to display the images, set the transformations to revert the normalization
    of the images and to convert the tensors into PIL images:'
  id: totrans-231
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了能够显示图像，设置转换以恢复图像的归一化，并将张量转换为PIL图像：
- en: '[PRE62]'
  id: totrans-232
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE62]'
- en: 'Create a function capable of performing the previous transformation over tensors.
    Call the function for both images and plot the results:'
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个能够对张量执行前述变换的函数。为两幅图像调用该函数并绘制结果：
- en: '[PRE63]'
  id: totrans-234
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE63]'
- en: 'Load the VGG-19 model:'
  id: totrans-235
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载VGG-19模型：
- en: '[PRE64]'
  id: totrans-236
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE64]'
- en: 'Create a dictionary mapping the index of the relevant layers (keys) to a name
    (values). Then, create a function to extract the feature maps of the relevant
    layers. Use them to extract the features of both input images:'
  id: totrans-237
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个将相关层的索引（键）映射到名称（值）的字典。然后，创建一个函数来提取相关层的特征图。使用它们来提取两个输入图像的特征：
- en: '[PRE65]'
  id: totrans-238
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE65]'
- en: 'Calculate the gram matrix for the style features. Also, create the initial
    target image:'
  id: totrans-239
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算样式特征的Gram矩阵。同时，创建初始目标图像：
- en: '[PRE66]'
  id: totrans-240
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE66]'
- en: 'Set the weights for different style layers, as well as the weights for the
    content and style losses:'
  id: totrans-241
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置不同风格层的权重，以及内容和风格损失的权重：
- en: '[PRE67]'
  id: totrans-242
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE67]'
- en: Run the model for 500 iterations. Define the Adam optimization algorithm before
    starting to train the model, using 0.001 as the learning rate.
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行500次迭代的模型。在开始训练模型之前，定义Adam优化算法，并使用0.001作为学习率。
- en: Note
  id: totrans-244
  prefs:
  - PREF_IND
  - PREF_H4
  type: TYPE_NORMAL
  zh: 注意
- en: '[PRE68]'
  id: totrans-245
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE68]'
- en: 'Plot both content and target images to compare the results:'
  id: totrans-246
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制内容和目标图像以比较结果：
- en: '[PRE69]'
  id: totrans-247
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE69]'
- en: 'The following is the plot derived from this code snippet:'
  id: totrans-248
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 以下是从此代码片段衍生的图：
- en: '![Figure 5.10: Plot of the content and target images](img/C11865_05_10.jpg)'
  id: totrans-249
  prefs: []
  type: TYPE_IMG
  zh: '![图5.10：内容和目标图像的绘图](img/C11865_05_10.jpg)'
- en: 'Figure 5.10: Plot of the content and target images'
  id: totrans-250
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图5.10：内容和目标图像的绘图
- en: 'Chapter 6: Analyzing the Sequence of Data with RNNs'
  id: totrans-251
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第6章：使用RNN分析数据序列
- en: 'Activity 11: Using a Simple RNN for a Time Series Prediction'
  id: totrans-252
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动11：使用简单RNN进行时间序列预测
- en: 'Solution:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import the required libraries, as follows:'
  id: totrans-254
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入所需的库，如下所示：
- en: '[PRE70]'
  id: totrans-255
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE70]'
- en: 'Set the seed equal to 0 to reproduce the results in this book, using the following
    line of code:'
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将种子设置为0以在本书中重现结果，使用以下代码行：
- en: '[PRE71]'
  id: totrans-257
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE71]'
- en: 'Load the dataset and then slice it so that it contains all the rows but only
    the columns from index 1 to 52:'
  id: totrans-258
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 载入数据集，然后将其切片，使其包含所有行但只有从索引1到52的列：
- en: '[PRE72]'
  id: totrans-259
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE72]'
- en: 'Plot the sales transactions by week of five randomly-chosen products from the
    entire dataset. Use a random seed of 0 when doing the random sampling in order
    to achieve the same results as in the current activity:'
  id: totrans-260
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制整个数据集中五种随机选择产品每周的销售交易。在进行随机抽样时使用随机种子0，以获得与当前活动相同的结果：
- en: '[PRE73]'
  id: totrans-261
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE73]'
- en: 'The resulting plot should look as follows:![Figure 6.21: Plot of the output](img/C11865_06_21.jpg)'
  id: totrans-262
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 结果图应如下所示：![图6.21：输出的绘图](img/C11865_06_21.jpg)
- en: 'Figure 6.21: Plot of the output'
  id: totrans-263
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图6.21：输出的绘图
- en: Create the `inputs` and `targets` variables that will be fed to the network
    to create the model. These variables should be of the same shape and be converted
    to PyTorch Tensors.
  id: totrans-264
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建将馈送到网络以创建模型的`inputs`和`targets`变量。这些变量应具有相同的形状，并转换为PyTorch张量。
- en: The `inputs` variable should contain the data for all products for all weeks,
    except the last week – as the idea of the model is to predict this final week.
  id: totrans-265
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`inputs`变量应包含所有产品所有周的数据，除了最后一周 — 因为模型的想法是预测这最后一周。'
- en: 'The `targets` variable should be one step ahead of the `inputs` variable –
    that is, the first value of the `targets` variable should be the second one of
    the inputs variable, and so on, until the last value of the targets variable (which
    should be the last week that was left outside of the `inputs` variable):'
  id: totrans-266
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`targets`变量应比`inputs`变量超前一步 — 即`targets`变量的第一个值应为`inputs`变量的第二个值，依此类推，直到`targets`变量的最后一个值（即`inputs`变量之外的最后一周）：'
- en: '[PRE74]'
  id: totrans-267
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE74]'
- en: 'Create a class containing the architecture of the network; note that the output
    size of the fully-connected layer should be 1:'
  id: totrans-268
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建包含网络架构的类；请注意完全连接层的输出大小应为1：
- en: '[PRE75]'
  id: totrans-269
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE75]'
- en: 'Initialize the `class` function containing the model; then, feed the input
    size, the number of neurons in each recurrent layer (10), and the number of recurrent
    layers (1):'
  id: totrans-270
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 初始化包含模型的`class`函数；然后，输入大小、每个循环层中的神经元数（10）和循环层数（1）：
- en: '[PRE76]'
  id: totrans-271
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE76]'
- en: 'Define a loss function, an optimization algorithm and the number of epochs
    to train the network; for example, you can use the Mean Squared Error loss function,
    the Adam optimizer, and 10,000 epochs:'
  id: totrans-272
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义损失函数、优化算法和要训练网络的时期数；例如，可以使用均方误差损失函数、Adam优化器和10,000个时期：
- en: '[PRE77]'
  id: totrans-273
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE77]'
- en: 'Use a `for` loop to perform the training process by going through all the epochs.
    In each epoch, a prediction must be made, along with the subsequent calculation
    of the loss function and the optimization of the parameters of the network. Save
    the loss of each of the epochs:'
  id: totrans-274
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`for`循环通过所有时期执行训练过程。在每个时期中，必须进行预测，并随后计算损失函数并优化网络参数。保存每个时期的损失：
- en: Note
  id: totrans-275
  prefs:
  - PREF_IND
  - PREF_H4
  type: TYPE_NORMAL
  zh: 注意
- en: '[PRE78]'
  id: totrans-276
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE78]'
- en: 'Plot the losses of all epochs, as follows:'
  id: totrans-277
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制所有时期的损失如下：
- en: '[PRE79]'
  id: totrans-278
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE79]'
- en: 'The resulting plot should look as follows:![Figure 6.22: Plot displaying the
    losses of all epochs](img/C11865_06_22.jpg)'
  id: totrans-279
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 结果图应如下所示：![图6.22：显示所有时期损失的绘图](img/C11865_06_22.jpg)
- en: 'Figure 6.22: Plot displaying the losses of all epochs'
  id: totrans-280
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图6.22：显示所有时期损失的绘图
- en: 'Using a scatter plot, display the predictions that were obtained in the last
    epoch of the training process against the ground truth values (that is, the sales
    transactions of the last week):'
  id: totrans-281
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用散点图，显示在训练过程的最后一个时期获得的预测值与基准真值（即上周的销售交易）：
- en: '[PRE80]'
  id: totrans-282
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE80]'
- en: 'The final plot should be as follows:'
  id: totrans-283
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最终的图应如下所示：
- en: '![Figure 6.23: Scatter plot displaying predictions](img/C11865_06_23.jpg)'
  id: totrans-284
  prefs: []
  type: TYPE_IMG
  zh: '![图6.23：显示预测的散点图](img/C11865_06_23.jpg)'
- en: 'Figure 6.23: Scatter plot displaying predictions'
  id: totrans-285
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图6.23：显示预测的散点图
- en: 'Activity 12: Text Generation with LSTM Networks'
  id: totrans-286
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动12：使用LSTM网络生成文本
- en: 'Solution:'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import the required libraries as follows:'
  id: totrans-288
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入所需的库如下：
- en: '[PRE81]'
  id: totrans-289
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE81]'
- en: 'Open and read the text from *Alice in Wonderland* into the notebook. Print
    an extract of the first 100 characters and the total length of the text file:'
  id: totrans-290
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开并读取《爱丽丝梦游仙境》中的文本到笔记本中。打印前 100 个字符的摘录和文本文件的总长度：
- en: '[PRE82]'
  id: totrans-291
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE82]'
- en: 'Create a variable containing a list of the unduplicated characters in your
    dataset. Then, create a dictionary that maps each character to an integer, where
    the characters will be the keys and the integers will be the values:'
  id: totrans-292
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个包含数据集中不重复字符的列表变量。接着，创建一个字典，将每个字符映射为一个整数，其中字符作为键，整数作为值：
- en: '[PRE83]'
  id: totrans-293
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE83]'
- en: 'Encode each letter of your dataset to their paired integer. Print the first
    100 encoded characters and the total length of the encoded version of your dataset:'
  id: totrans-294
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将数据集中的每个字母编码为它们的配对整数。打印前 100 个编码字符和您的数据集编码版本的总长度：
- en: '[PRE84]'
  id: totrans-295
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE84]'
- en: 'Create a function that takes in a batch and encodes it as a one-hot matrix:'
  id: totrans-296
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个函数，接收一个批次并将其编码为一个独热矩阵：
- en: '[PRE85]'
  id: totrans-297
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE85]'
- en: 'Create the class that defines the architecture of the network. The class should
    contain an additional function that initializes the states of the LSTM layers:'
  id: totrans-298
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建定义网络架构的类。该类应包含一个额外的函数，初始化 LSTM 层的状态：
- en: '[PRE86]'
  id: totrans-299
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE86]'
- en: 'Determine the number of batches to be created out of your dataset, bearing
    in mind that each batch should contain 100 sequences, and each with a length of
    50\. Next, split the encoded data into 100 sequences:'
  id: totrans-300
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定要从数据集中创建的批次数量，每个批次应包含 100 个序列，每个序列长度为 50。然后，将编码数据拆分为 100 个序列：
- en: '[PRE87]'
  id: totrans-301
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE87]'
- en: 'Initialize your model, using 256 as the number of hidden units for a total
    of 2 recurrent layers:'
  id: totrans-302
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 初始化您的模型，使用 256 作为总共 2 个循环层的隐藏单元数：
- en: '[PRE88]'
  id: totrans-303
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE88]'
- en: 'Define the loss function and the optimization algorithms. Use the Adam optimizer
    and the cross-entropy loss:'
  id: totrans-304
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义损失函数和优化算法。使用 Adam 优化器和交叉熵损失：
- en: '[PRE89]'
  id: totrans-305
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE89]'
- en: 'Train the network for 20 epochs, bearing in mind that, in each epoch, the data
    must be divided into batches with a sequence length of 50\. This means, that each
    epoch with have 100 epochs, each with a sequence of 50:'
  id: totrans-306
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 训练网络 20 个时期，每个时期的数据需分为序列长度为 50 的批次。这意味着每个时期将有 100 个批次，每个批次有一个长度为 50 的序列：
- en: '[PRE90]'
  id: totrans-307
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE90]'
- en: 'Plot the progress of the `loss` function over time:'
  id: totrans-308
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制随时间推移的`loss`函数进展：
- en: '[PRE91]'
  id: totrans-309
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE91]'
- en: 'The chart should look as follows:![Figure 6.24: Chart displaying progress of
    the loss function'
  id: totrans-310
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 图表应如下所示：![图 6.24：显示损失函数进展的图表
- en: '](img/C11865_06_24.jpg)'
  id: totrans-311
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '![图示 6.24](img/C11865_06_24.jpg)'
- en: 'Figure 6.24: Chart displaying progress of the loss function'
  id: totrans-312
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 6.24：显示损失函数进展的图表
- en: 'Feed the following sentence starter into the trained model and complete the
    sentence:'
  id: totrans-313
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将以下句子开头输入训练好的模型，并完成该句子：
- en: '"So she was considering in her own mind"'
  id: totrans-314
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '"她正在自己的心里考虑"'
- en: '[PRE92]'
  id: totrans-315
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE92]'
- en: 'The final sentence will vary considering that there is a random factor when
    it comes to choosing each character, however it should look something like this:'
  id: totrans-316
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最终句子会因为在选择每个字符时存在随机因素而有所不同，但它应该看起来像这样：
- en: '[PRE93]'
  id: totrans-317
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE93]'
- en: The preceding sentence does not have a meaning considering that the network
    selects each character at a time, without a long-term memory of the previously-created
    words. Nevertheless, we can see that after only 20 epochs, the network is already
    capable of forming some words that have a meaning.
  id: totrans-318
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 前一句并没有意义，因为网络一次选择一个字符，没有长期记忆以前创建的单词。然而，我们可以看到在仅仅 20 个时期后，网络已经能够形成一些有意义的单词。
- en: 'Activity 13: Performing NLP for Sentiment Analysis'
  id: totrans-319
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 活动 13：进行情感分析的自然语言处理
- en: 'Solution:'
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案：
- en: 'Import the required libraries:'
  id: totrans-321
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入所需的库：
- en: '[PRE94]'
  id: totrans-322
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE94]'
- en: 'Load the dataset containing a set of 1,000 product reviews from Amazon, which
    is paired with a label of 0 (for negative reviews) or 1 (for positive reviews).
    Separate the data into two variables – one containing the reviews and the other
    containing the labels:'
  id: totrans-323
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 载入包含 1,000 条亚马逊产品评论及其标签（0 表示负面评论，1 表示正面评论）的数据集。将数据分为两个变量 – 一个包含评论，另一个包含标签：
- en: '[PRE95]'
  id: totrans-324
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE95]'
- en: 'Remove the punctuation from the reviews:'
  id: totrans-325
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 移除评论中的标点符号：
- en: '[PRE96]'
  id: totrans-326
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE96]'
- en: 'Create a variable containing the vocabulary of the entire set of reviews. Additionally,
    create a dictionary that maps each word to an integer, where the words will be
    the keys and the integers will be the values:'
  id: totrans-327
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个包含整个评论集的词汇表的变量。此外，创建一个字典，将每个单词映射为一个整数，其中单词作为键，整数作为值：
- en: '[PRE97]'
  id: totrans-328
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE97]'
- en: 'Encode the reviews data by replacing each word in a review for its paired integer:'
  id: totrans-329
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过用每个单词在评论中的配对整数替换来对评论数据进行编码：
- en: '[PRE98]'
  id: totrans-330
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE98]'
- en: 'Create a class containing the architecture of the network. Make sure that you
    include an embedding layer:'
  id: totrans-331
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个包含网络架构的类。确保包含嵌入层：
- en: '[PRE99]'
  id: totrans-332
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE99]'
- en: 'Initialize the model using 64 embedding dimensions and 128 neurons for 3 LSTM
    layers:'
  id: totrans-333
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 64 个嵌入维度和 128 个神经元的 3 个 LSTM 层来初始化模型：
- en: '[PRE100]'
  id: totrans-334
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE100]'
- en: 'Define the loss function, an optimization algorithm, and the number of epochs
    to train for. For example, you can use the binary cross-entropy loss as the loss
    function, the Adam optimizer, and train for 10 epochs:'
  id: totrans-335
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义损失函数、优化算法和训练的时期数。例如，您可以使用二元交叉熵损失作为损失函数，Adam 优化器，并训练 10 个时期：
- en: '[PRE101]'
  id: totrans-336
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE101]'
- en: 'Create a `for` loop that goes through the different epochs and through every
    single review individually. For each review, perform a prediction, calculate the
    loss function, and update the parameters of the network. Additionally, calculate
    the accuracy of the network over that training data:'
  id: totrans-337
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个`for`循环，遍历不同的时期和每个单独的评论。对于每个评论，执行预测，计算损失函数，并更新网络的参数。另外，计算网络在该训练数据上的准确率：
- en: '[PRE102]'
  id: totrans-338
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE102]'
- en: 'Plot the progress of the loss function and accuracy over time:'
  id: totrans-339
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制损失函数和准确率随时间的进展：
- en: '[PRE103]'
  id: totrans-340
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE103]'
- en: 'The output plot should look as follows:![Figure 6.25: Plot displaying the progress
    of the loss function](img/C11865_06_25.jpg)'
  id: totrans-341
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输出图应如下所示：![图 6.25：显示损失函数进展的图表](img/C11865_06_25.jpg)
- en: 'Figure 6.25: Plot displaying the progress of the loss function'
  id: totrans-342
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 6.25：显示损失函数进展的图表
- en: '[PRE104]'
  id: totrans-343
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE104]'
- en: 'The plot should look as follows:'
  id: totrans-344
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 图应如下所示：
- en: '![Figure 6.26: Plot displaying progress of accuracy](img/C11865_06_26.jpg)'
  id: totrans-345
  prefs: []
  type: TYPE_IMG
  zh: '![图 6.26：显示准确率进展的图表](img/C11865_06_26.jpg)'
- en: 'Figure 6.26: Plot displaying progress of accuracy'
  id: totrans-346
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 6.26：显示准确率进展
